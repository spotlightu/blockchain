# Лабораторная работа №4  
## Добавление механизма Proof-of-Work в распределённый блокчейн

### Цель работы
Научиться добавлять в распределённую блокчейн-сеть механизм консенсуса **Proof-of-Work (PoW)** и понять, как он влияет на безопасность и работу сети.

---

### Описание проекта
Программа имитирует работу трёх узлов блокчейн-сети.  
Каждый узел может:
- создавать и майнить новые блоки;
- рассылать блоки другим узлам;
- принимать и проверять полученные блоки;
- проверять целостность своей цепочки.

Используется упрощённая модель сети и консенсуса — **первый, кто найдёт правильный хеш, побеждает**.

---

### Используемые технологии
- Язык: **Python 3**
- Библиотеки: `hashlib`, `datetime`, `queue`, `time`, `threading`

---

### Как запустить
1. Сохраните файл как `lab4.py`  
2. Запустите в терминале:
   ```bash
   python lab4.py
   ```
3. В консоли появится пошаговый вывод работы узлов, майнинга и проверки цепочки.

---

### Основные классы

#### **Block**
Описывает отдельный блок.  
Поля:
- `index` — номер блока  
- `timestamp` — время создания  
- `data` — данные (например, текст транзакции)  
- `previous_hash` — хеш предыдущего блока  
- `creator` — кто создал блок  
- `nonce` — число, подобранное при майнинге  
- `hash` — хеш блока  

Методы:
- `calculate_hash()` — считает хеш блока  
- `mine_block(difficulty)` — выполняет Proof-of-Work: подбирает `nonce`, чтобы хеш начинался с заданного количества нулей  

---

#### **Blockchain**
Описывает локальную цепочку блоков.  
Методы:
- `create_genesis_block()` — создаёт первый блок  
- `add_block(data, creator)` — добавляет новый блок после майнинга  
- `is_valid()` — проверяет целостность всей цепочки

---

#### **Node**
Имитация узла сети.  
Методы:
- `create_and_broadcast_block(data)` — создаёт и рассылает новый блок  
- `receive_block(block)` — принимает и проверяет блок от другого узла  
- `process_next_message()` — обрабатывает входящие блоки  

---

### Этапы работы программы
1. Создаются три узла (`Node_1`, `Node_2`, `Node_3`)  
2. Запускается **одновременный майнинг** двумя узлами  
3. Узлы обмениваются блоками и решают, чей блок принять  
4. Печатаются итоговые цепочки и проверяется консенсус  
5. Проверяется защита от подделки данных (изменение блока делает цепочку невалидной, пока не произойдёт перемайнинг)

---

### Пример вывода (сокращённо)
```
=== СИМУЛЯЦИЯ СЕТИ С PoW ===
Node_1 добыл блок #1: nonce=8164
Node_2 добыл блок #1: nonce=2665
Node_3 принял блок 'Транзакция А' от Node_1
❌ Консенсус не достигнут

=== ПРОВЕРКА ЗАЩИТЫ ===
Изменённый блок → цепочка невалидна
Перемайнинг → цепочка снова валидна
```

---

### Теоретические ответы (кратко)
- **PoW** делает атаки дорогими, т.к. требует вычислительных затрат.  
- **Сложность** влияет на скорость майнинга и безопасность.   
- **Недостатки PoW:** энергозатраты, медленное добавление блоков.  
- **CRC32 нельзя использовать**, потому что это не криптостойкий хеш.

---